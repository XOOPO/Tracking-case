<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Futuristic Case Dashboard</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

    <style>

    /* ===== NEW MODERN SIDEBAR ===== */
    .sidebar {
        width: 250px;
        height: 100vh;
        position: fixed;
        top: 0;
        left: 0;
        background: #0d0f15;
        padding: 20px 18px;
        border-right: 1px solid #1f1f1f;
        color: #ccc;
        z-index: 1000;
    }

    .sidebar h3 {
        font-size: 22px;
        font-weight: 700;
        margin-bottom: 35px;
        color: #fff;
    }

    .sidebar a {
        display: flex;
        align-items: center;
        gap: 14px;
        font-size: 19px;          /* ‚¨ÖÔ∏è HURUF LEBIH BESAR */
        font-weight: 600;         /* ‚¨ÖÔ∏è LEBIH TEBAL */
        padding: 12px 16px;       /* ‚¨ÖÔ∏è LEBIH LEBAR & RAPI */
        margin-bottom: 10px;
        border-radius: 12px;
        text-decoration: none;
        color: #f5f5f5;
        transition: 0.25s;
    }

    .sidebar a:hover {
        background: #1b1d24;
    }

    .sidebar a.active-link {
        background: #3b82f6;
        color: #fff;
    }

    .sidebar a i {
        font-size: 20px;
    }

    /* BACKGROUND */
    body {
        background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
        font-family: Arial, sans-serif;
        color: #e0e0e0;
        overflow-x: hidden;
    }

    /* MAIN CONTENT */
    .main-container {
        margin-left: 250px;
        padding: 80px 30px 40px 30px;
        max-width: 2400px;
    }

    /* RUNNING TEXT */
    .running-text-wrapper {
        position: fixed;
        top: 0;
        left: 250px;
        right: 0;
        height: 40px;
        background: rgba(0,0,0,0.6);
        display: flex;
        align-items: center;
        padding-left: 15px;
        color: #CCFF00;
        z-index: 2000;
        overflow: hidden;
    }

    .running-text {
        white-space: nowrap;
        padding-left: 100%;
        animation: runtext 16s linear infinite;
        font-weight: bold;
        font-size: 18px;
    }

    @keyframes runtext {
        0% { transform: translateX(0); }
        100% { transform: translateX(-100%); }
    }

    /* CARD */
    .card {
        background: rgba(20,20,30,0.9);
        border-radius: 15px;
        box-shadow: 0 0 25px rgba(0,255,255,0.4);
        border: 1px solid rgba(0,255,255,0.3);
        padding: 20px;
    }

    /* TABLE */
    .table-wrapper-fix {
        width: 100%;
        overflow-x: visible !important;
    }

    table.table {
        width: 100% !important;
        table-layout: fixed !important;
        border-collapse: collapse;
    }

    .table th,
    .table td {
        text-align: center !important;
        vertical-align: middle !important;
        padding: 10px 12px;
        white-space: normal !important;
        word-break: break-word;
    }

    .table thead th {
        background: rgba(0,255,255,0.15);
        color: #00ffff;
        border-bottom: 1px solid #00ffff;
        font-weight: bold;
    }

    th:nth-child(1), td:nth-child(1) { width: 5%; }
    th:nth-child(2), td:nth-child(2) { width: 8%; }
    th:nth-child(3), td:nth-child(3) { width: 5%; }
    th:nth-child(4), td:nth-child(4) { width: 5%; }
    th:nth-child(5), td:nth-child(5) { width: 18%; }
    th:nth-child(6), td:nth-child(6) { width: 6%; }
    th:nth-child(7), td:nth-child(7) { width: 6%; }
    th:nth-child(8), td:nth-child(8) { width: 20%; }
    th:nth-child(9), td:nth-child(9) { width: 8%; }
    th:nth-child(10), td:nth-child(10) { width: 9%; }
    th:nth-child(11), td:nth-child(10) { width: 8%; }

    .highlight {
        background: yellow;
        color: black;
        font-weight: bold;
    }

    .pagination .active .page-link {
        background-color: #00ffff;
        color: #000;
        border-color: #00ffff;
    }

    </style>
</head>
<body>

<!-- SIDEBAR -->
<div class="sidebar">
    <h3>TRACKING CASE</h3>

    <a href="/?sheet=Main" class="{% if selected_sheet == 'MAIN' %}active-link{% endif %}">
        <i class="bi bi-grid"></i> Main
    </a>

    <a href="/?sheet=AIA" class="{% if selected_sheet == 'AIA' %}active-link{% endif %}">
        <i class="bi bi-envelope"></i> AIA
    </a>

    <a href="/?sheet=OCR" class="{% if selected_sheet == 'OCR' %}active-link{% endif %}">
        <i class="bi bi-file-earmark-text"></i> OCR
    </a>

    <a href="/?sheet=MYR" class="{% if selected_sheet == 'MYR' %}active-link{% endif %}">
        <i class="bi bi-currency-dollar"></i> MYR
    </a>

    <a href="/?sheet=SGD" class="{% if selected_sheet == 'SGD' %}active-link{% endif %}">
        <i class="bi bi-cash-coin"></i> SGD
    </a>

    <a href="/?sheet=CRM" class="{% if selected_sheet == 'CRM' %}active-link{% endif %}">
        <i class="bi bi-person-lines-fill"></i> CRM
    </a>

    <a href="/?sheet=CTX" class="{% if selected_sheet == 'CTX' %}active-link{% endif %}">
        <i class="bi bi-diagram-3"></i> CTX
    </a>

    <a href="/?sheet=GRP" class="{% if selected_sheet == 'GRP' %}active-link{% endif %}">
        <i class="bi bi-people"></i> GRP
    </a>

    <a href="/?sheet=Suggestions" class="{% if selected_sheet == 'Suggestions' %}active-link{% endif %}">
        <i class="bi bi-lightbulb"></i> Suggestion
    </a>
</div>

<!-- RUNNING TEXT -->
<div class="running-text-wrapper">
    <div class="running-text">
        üîî Latest update: The dashboard data is automatically updated every day! üîî
    </div>
</div>

<!-- MAIN CONTENT -->
<div class="main-container">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold text-info">üìä Tracking Case Dashboard</h2>

        <div>
            <a href="/add" class="btn btn-primary me-2">‚ûï Add Case</a>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#suggestionModal">üí° Add Suggestion</button>
        </div>
    </div>

    <!-- SEARCH -->
    <form method="GET" action="/" class="d-flex mb-3">
        <input type="hidden" name="sheet" value="{{ selected_sheet }}">
        <input type="text" name="search" placeholder="Search Case ID..." class="form-control w-25 me-2" value="{{ search_query }}">
        <button type="submit" class="btn btn-primary">Search</button>
    </form>

    <!-- TABLE -->
    <div class="card">
        <div class="table-wrapper-fix">
            <table class="table table-bordered table-hover text-light">
                <thead>
                    <tr>
                        {% for h in headers %}
                        <th>{{ h }}</th>
                        {% endfor %}
                        <th>Telegram Link</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in records %}
                    <tr>
                        {% for h in headers %}
                        <td>
                            {% if search_query %}
                                {{ row[h]|string|replace(search_query, '<span class="highlight">' + search_query + '</span>')|safe }}
                            {% else %}
                                {{ row[h] }}
                            {% endif %}
                        </td>
                        {% endfor %}
                        <td>
                            {% if row['Telegram Link'] %}
                                <a href="{{ row['Telegram Link'] }}" target="_blank" class="text-info fw-bold">Open</a>
                            {% else %}
                                -
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- PAGINATION -->
    <div class="d-flex justify-content-center mt-3">
        {% if total_pages > 1 %}
        <nav>
            <ul class="pagination">
                {% if page > 1 %}
                <li class="page-item"><a class="page-link" href="?sheet={{selected_sheet}}&page={{page-1}}&search={{search_query}}">Previous</a></li>
                {% endif %}

                {% for p in range(1, total_pages+1) %}
                <li class="page-item {% if p == page %}active{% endif %}">
                    <a class="page-link" href="?sheet={{selected_sheet}}&page={{p}}&search={{search_query}}">{{p}}</a>
                </li>
                {% endfor %}

                {% if page < total_pages %}
                <li class="page-item"><a class="page-link" href="?sheet={{selected_sheet}}&page={{page+1}}&search={{search_query}}">Next</a></li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}
    </div>

</div>

<!-- BOOTSTRAP -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
